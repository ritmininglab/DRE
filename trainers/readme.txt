Training and inference related additional code 
